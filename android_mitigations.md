We list mitigations added in all Android versions.

| Version (and date) | Mitigation | References |
|--------------------|------------|------------------------------------------|
| 2.3 |	Binaries compiled with non-executable and heap | [26][26] |
| 2.3 |	Stack ramdomised |	? |
| 4.0 |	Libraries randomised |	? |
| 4.0.2 |	Heap randomised | ? |
| unknown | Executables randomized | [24][24] |
| 4.1 |	default umask 0077 | ? |
| 4.1 |	Linker randomised |	? |
| 4.1 |	isolatedProcess introduction |	? |
| 4.1.1 |	mmap_min_addr increased to 32768 	| ? |
| 4.1.1 |	/proc/kallsyms not available. kptr_restrict to control it. | [9][9] [10][10] [11][11] |
| 4.3 |	SELinux in permissive mode |	? |
| 4.3 |	deletion of setuid/setgid binaries |	? |
| 4.3 |	deletion of Linux capabilities in dans zygote/adbd | ? |
| 4.4 |	SELinux in enforcing mode to crucial domains |	? |
| 5.0 |	SELinux in enforcing mode to all domains |	[12][12] |
| 6.x? |	isolatedApplicationData | [13][13] |
| 6.x? |	preventAppDataExecution | [1][1] |
| N |	UndefinedBehaviorSanitizer (UBSan) allowing Integer Overflow Sanitization (IntSan) in media stack 	| [2][2] [3][3] |
| N |	mediaserver containment / some media services are in their individual service processes (sandboxed) |	[4][4] [5][5] |
| ? |	trustzone |	[6][6] |
| O |	Privileged Access Never (PAN) emulation |	[7][7] [8][8] |
| O |	Hardened usercopy (w/o whitelist) |	[7][7] [8][8] |
| O |	Post-init read-only memory (__ro_after_init) |	[7][7] [8][8] |
| O |	Kernel Address Space Layout Randomization (KASLR) |	[8][8] |
| O |	media service processes converted into HALs |	[5][5] [15][15] |
| O |	SECURE_DELETE on SQLite databases |	[16][16] |
| O |	Control Flow Integrity (CFI) in select components |	[3][3] |
| P |	Control Flow Integrity (CFI) in more components by default (media framework, NFC, Bluetooth) 	| [3][3] [17][17] [5][5] |
| P |	Kernel Control Flow Integrity (kCFI) into Android common kernel |	[3][3] [14][14] |
| P |	Integer Overflow Sanitization (IntSan) in more libraries (libui, libnl, libmediaplayerservice, libexif, libdrmclearkeyplugin, libreverbwrapper) and reduced performance overhead by 75% |	[3][3] |
| Q |	software media codecs moved into constrained sandbox in system service (mediaswcodec sandbox, based on SELinux and seccomp, no access to device drivers) |	[5][5] |
| Q |	LLVM's bound sanitizer (BoundSan) to fail safely when array's overflow, at compile time, enabled on 11 media codecs and Bluetooth's stack |	[5][5] |
| Q |	Integer Overflow Sanitization (IntSan) to fail safely when integer overflow, at compile time in all media framework |	[5][5] |
| Q |	LLVM's Shadow Call Stack (SCS) to protect return addresses (x18 register) in Bluetooth stack and some parts of the kernel |	[5][5] |
| Q |	eXecute-Only Memory (XOM) makes code unreadable for Aarch64, ARMv8.2+ and Linux 4.9+ devices |	[5][5]
| Q |	Scudo Hardened Allocator (resilience against UAF, double-frees, BOF, heap sprays) enabled in media extractors and codecs  | [5][5] |
| unknown | Stack Protector Strong | [18][18] |
| unknown | RELRO/NOW | [19][19] [22][22] [23][23] |
| unknown | -Wl,--fatal-warnings and -Wl,--warn-shared-textrel | [20][20] | 
| unknown | -D_FORTIFY_SOURCE | [21][21] |
| unknown | -Werror=format-security | [25][25]

[1]: https://android-review.googlesource.com/#/c/169950/
[2]: http://android-developers.blogspot.co.uk/2016/05/hardening-media-stack.html
[3]: https://android-developers.googleblog.com/2018/06/compiler-based-security-mitigations-in.html
[4]: http://android-developers.blogspot.co.uk/2016/05/hardening-media-stack.html
[5]: https://android-developers.googleblog.com/2019/05/queue-hardening-enhancements.html
[6]: http://keenlab.tencent.com/en/2016/06/01/Emerging-Defense-in-Android-Kernel/
[7]: https://twitter.com/CopperheadOS/status/900151927610232832
[8]: https://android-developers.googleblog.com/2017/08/hardening-kernel-in-android-oreo.html
[9]: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=455cd5ab305c90ffc422dd2e0fb634730942b257
[10]: http://insitusec.blogspot.co.uk/2013/01/kallsyms-on-android.html
[11]: https://www.duosecurity.com/blog/exploit-mitigations-in-android-jelly-bean-4-1
[12]: http://source.android.com/devices/tech/security/selinux/index.html
[13]: https://android-review.googlesource.com/#/c/171970/
[14]: https://android-review.googlesource.com/q/topic:android-4.14-cfi
[15]: https://android-developers.googleblog.com/2016/05/hardening-media-stack.html
[16]: https://twitter.com/CopperheadOS/status/900206828683964417
[17]: https://android.googlesource.com/platform/build/+/e003a0a6cec52c2a8bd561673509f3a34bc5c052/target/product/cfi-common.mk
[18]: https://android.googlesource.com/platform/build/+/8765b1035f813be2c26988a73cf3e9815aa5adf6
[19]: https://android.googlesource.com/platform/build/+/45545761d20e1eab324b8ce302afceb9c440c2a3
[20]: https://android.googlesource.com/platform/build/+/46ed4aa58b9674aadf75b4c35d0394831bbe6bad
[21]: https://android-developers.googleblog.com/2017/04/fortify-in-android.html
[22]: https://android.googlesource.com/platform/build/+/ecb1a565849b40ab7aa45b7fe71e24e29a059376
[23]: https://android.googlesource.com/platform/build/+/233d460f21d372f964f8078b8b0d5fd17af7c6b6
[24]: https://android.googlesource.com/platform/build/+/026a85b129e4540a4d8d40aace47aa0c69f609da
[25]: https://android.googlesource.com/platform/build/+/d868cad8284730bd902a354a984dc57c870802fc
[26]: https://android.googlesource.com/platform/build/+/2915cc3e323a9bf86e1a20b201ceb4e9529bc5a2
